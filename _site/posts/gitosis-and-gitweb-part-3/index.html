<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Gitosis and Gitweb - Part 3 &#8211; Jason Meridth</title>
<meta name="description" content="Blog of Jason Meridth - Learn, Converse, Share">
<meta name="keywords" content="git, gitosis">

<!-- Twitter Cards -->
  
    <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@jmeridth">
  <meta name="twitter:creator" content="@jmeridth">
  <meta name="twitter:image" content="/images/meridth_llc_cog.png">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Gitosis and Gitweb - Part 3">
<meta property="og:description" content="Blog of Jason Meridth - Learn, Converse, Share">
<meta property="og:url" content="https://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-3/">
<meta property="og:site_name" content="Jason Meridth">
<meta property="og:image" content="https://blog.jasonmeridth.com/images/images/logo.jpg">

<meta name="google-site-verification" content="2LRsgnHFM86Lph9HmYJGK6Uoa-Fn75nSU9YdAGbZAo4">



<link rel="canonical" href="https://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-3/">
<link href="https://blog.jasonmeridth.com/feed.xml" type="application/atom+xml" rel="alternate" title="Jason Meridth Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="https://blog.jasonmeridth.com/assets/css/main.css">
<link rel="stylesheet" href="https://blog.jasonmeridth.com/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="https://blog.jasonmeridth.com/assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script type="text/javascript" src="https://blog.jasonmeridth.com/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://blog.jasonmeridth.com/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://blog.jasonmeridth.com/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://blog.jasonmeridth.com/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://blog.jasonmeridth.com/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://blog.jasonmeridth.com/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blog.jasonmeridth.com/images/apple-touch-icon-144x144-precomposed.png">




</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="header-menu header-menu-top">
    <ul class="header-item-container">
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="https://blog.jasonmeridth.com/">
          
            <img class="logo" src="https://blog.jasonmeridth.com/images/logo.jpg" alt="Jason Meridth">
          
          <a href="https://blog.jasonmeridth.com/" class="title"> Jason Meridth</a>
        </a>
      </li>
      
        
        

        
            
                <li class="header-item "><a href="https://blog.jasonmeridth.com/feed.xml"><h3>RSS</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://blog.jasonmeridth.com/about"><h3>About</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://blog.jasonmeridth.com/tags"><h3>Tags</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://blog.jasonmeridth.com/"><h3>Home</h3></a></li>
            
        
      
      <li class="header-item"><a href="https://blog.jasonmeridth.com/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
<div class="entry-header">
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Gitosis and Gitweb - Part 3</h1>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="https://blog.jasonmeridth.com/"><h3>Home</h3></a></li>
      
    
      
        <li><a href="https://blog.jasonmeridth.com/tags"><h3>Tags</h3></a></li>
      
    
      
        <li><a href="https://blog.jasonmeridth.com/about"><h3>About</h3></a></li>
      
    
      
        <li><a href="https://blog.jasonmeridth.com/feed.xml"><h3>RSS</h3></a></li>
      
    
  </ul>
</nav>


  <a href="https://twitter.com/jmeridth" class="btn btn-info button-twitter" data-show-count="false" data-size="large"><i class="fa fa-twitter"></i> <span> | Follow @jmeridth</span></a>



<div id="main" role="main">
  <article class="hentry">
    <div class="entry-content">
        

      <div class="entry-meta">
        <span class="entry-date date published updated">
          <time datetime="2010-05-26T04:45:00-05:00"><a href="https://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-3/">May 26, 2010</a></time>
        </span>
        
        <span class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
          Reading time ~1 minute
        </span><!-- /.entry-reading-time -->
        
      </div><!-- /.entry-meta -->
      <h1 class="post-title entry-title">Gitosis and Gitweb - Part 3</h1>
      <div class="entry-meta">
        <span class="entry-tags"><a href="https://blog.jasonmeridth.com/tags#git" title="Pages tagged git" class="tag"><span class="term">git</span></a><a href="https://blog.jasonmeridth.com/tags#gitosis" title="Pages tagged gitosis" class="tag"><span class="term">gitosis</span></a></span>
      </div>

      <p><a href="/posts/gitosis-and-gitweb-part-1">Gitosis and Gitweb – Part 1</a></p>

<p><a href="/posts/gitosis-and-gitweb-part-2">Gitosis and Gitweb – Part 2</a></p>

<p>So we are setup, have a project, and have contributors via the first 2 parts.</p>

<p>I know that we are all enamored by the UI of <a href="http://github.com">GitHub.com</a>. I am. Unfortunately you can’t get private repositories for free (In all fairness it’s only $7/mo. – a <em>very</em> wise investment). I am aware of <a href="http://gitorious.com">Gitorious</a> like I mentioned in the first part, but I have no experience with that. I will after this series and update this series if I find it better. Again, I like to use the simplest thing that works. (Of course, “simplest” is in the eye of the beholder)</p>

<p>In this section I’m going to show you how to install Gitweb, a UI tool that let’s you view your repositories. I’m also going to mention how to get it to auto-detect any new repositories and ensure they show up on the web UI. I learned how to do most of this from my co-worker <a href="http://twitter.com/ajmesserli">Antony Messerli</a>. He is a true Linux and problem-solving Jedi.</p>

<h2 id="install-apache">Install Apache</h2>

<p>First, you need to ensure apache2 is installed. Check to see if you have an /etc/apache2 folder. If you do, you should be okay. If you don’t, you need to install it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>apache2
</code></pre></div></div>

<p>For more in-depth advice, I always reference the <a href="http://articles.slicehost.com/2010/5/19/installing-apache-on-ubuntu">Slicehost Articles</a></p>

<p>Once you have that installed the daemon restarted, go to your slices ip address in the browser of your choice (i.e,. http://123.123.123.123) and you should something like “It Works”</p>

<p>Voila! You have apache running.</p>

<h2 id="install-the-package">Install the Package</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>gitweb
</code></pre></div></div>

<p>This will install gitweb into /var/www/gitweb, create a conf file at /etc/gitweb.conf, and add three files to /usr/share/gitweb (git-favicon.png, git-logo.png, gitweb.css).</p>

<p>Note: If for some reason, the /var/www/gitweb folder <em>is not</em> created, you can clone the git source (git clone git://git.kernel.org/pub/scm/git/git.git) and then just copy the git/gitweb folder to /var/www/gitweb</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> <span class="nt">-R</span> git/gitweb /var/www/
</code></pre></div></div>

<p>You only need to edit the $projectroot variable in the /etc/gitweb.conf to point to your gitosis repositories folder:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># path to git projects (&lt;project&gt;.git)</span>
<span class="nv">$projectroot</span> <span class="o">=</span> <span class="s2">"/home/git/repositories"</span><span class="p">;</span>
...
</code></pre></div></div>

<p>Since this isn’t a post about Apache, I just add the gitweb directory setup to the base Apache config. Since Ubuntu includes the entire /etc/apache2/conf.d directory, I just added the following information into /etc/apach2/conf.d/gitweb:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RewriteEngine on
RewriteRule ^/gitweb/<span class="o">([</span>a-zA-Z0-9_<span class="se">\-</span><span class="o">]</span>+<span class="se">\.</span>git<span class="o">)</span>/?<span class="o">(</span><span class="se">\?</span>.<span class="k">*</span><span class="o">)</span>?<span class="nv">$ </span>/cgi-bin/gitweb.cgi/<span class="nv">$1</span> <span class="o">[</span>L,PT]

Alias /gitweb /home/git/repositories
&lt;Directory /home/git/repositories&gt;
Options Indexes FollowSymlinks ExecCGI
DirectoryIndex /cgi-bin/gitweb.cgi
AllowOverride None
&lt;/Directory&gt;
</code></pre></div></div>

<p>Restart Apache to make sure everything works</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> /etc/init.d/apache2 restart
</code></pre></div></div>

<p>The first time you go to your website again, you’ll see Gitweb, but it’ll say no projects are available. Fix mentioned below.</p>

<h3 id="two-hacks-open-to-suggestions">Two Hacks (open to suggestions)</h3>

<p>1. I had to copy the git-favicon.png, git-logo.png, gitweb.css files from /usr/share/gitweb to /var/www/gitweb/. (if you had to do what is mentioned in the Note above, you don’t have to do this, since the gitweb folder from the git source clone includes these files already)</p>

<p>2. I had to make the repositories that I wanted visible in gitweb have permissions of 755 (aka owner has read, write, execute. group and others have read, execute.)</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo chmod</span> <span class="nt">-R</span> 755 /git/repositories/lostechies.git
</code></pre></div></div>

<p>Once that was done I can see the repository and it’s information on Gitweb.</p>

<p><img src="https://blog.jasonmeridth.com/images/gitweb-part3.png" alt="" /></p>

<p>If you want to edit the project description from “Unnamed repository; edit this file ‘description’ to name the repository.” go to the repositories description file (/home/git/repositories/          lostechies.git/description for this repo) and edit the file and save.</p>

<h3 id="cron-job">Cron job</h3>

<p>I, again with the leadership of Ant, utilized a cron job he wrote to automatically make the repositories have permissions of 755. I do have some repositories, like gitosis-admin, that I do not ever want visible on Gitweb. The cron job excludes them. Here is the cron job code, showing that I don’t want to show my personal.git and gitosis-admin.git repositories. This could be easily written in Ruby or any other “scripting language” of your choice:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>

<span class="nv">GITOSIS_REPO_PATH</span><span class="o">=</span><span class="s2">"/home/git/repositories"</span>
<span class="nv">GITOSIS_ADMIN_PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$GITOSIS_REPO_PATH</span><span class="s2">/gitosis-admin.git"</span>
<span class="nv">PERSON_REPO_PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$GITOSIS_REPO_PATH</span><span class="s2">/personal.git"</span>

debug <span class="o">()</span>
<span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">"[D]: </span><span class="nv">$1</span><span class="s2">"</span> <span class="o">&gt;</span> /dev/null
<span class="o">}</span>

<span class="k">for </span><span class="nb">dir </span><span class="k">in</span> <span class="sb">`</span>find <span class="nv">$GITOSIS_REPO_PATH</span> <span class="nt">-maxdepth</span> 1 <span class="nt">-mindepth</span> 1 <span class="nt">-type</span> d<span class="sb">`</span><span class="p">;</span> <span class="k">do
    if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$dir</span><span class="s2">"</span> <span class="o">!=</span> <span class="s2">"</span><span class="nv">$GITOSIS_ADMIN_PATH</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$dir</span><span class="s2">"</span> <span class="o">!=</span> <span class="s2">"</span><span class="nv">$PERSON_REPO_PATH</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
             <span class="sb">`</span><span class="nb">chmod</span> <span class="nt">-R</span> 0755 <span class="nv">$dir</span><span class="sb">`</span>
        <span class="k">fi
    fi
    </span>debug <span class="s2">"All repositories have permissions set to 0755"</span>
<span class="k">done</span>
</code></pre></div></div>

<p>I chose bash, so that I could take that time to learn it.<br />
Translation: Find all the directories in my gitosis repository path (/home/git/repositories) and if they are not gitosis-admin or personal, change their permissions, recursively, to 0755.</p>

<p>I put this in a file called set_gitosis_permissions_to_view_on_gitweb.sh and put it in root’s home folder, /root. I then called the file from root’s crontab:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ /&gt; <span class="nb">sudo </span>su -
<span class="c"># /root &gt; crontab -e</span>
<span class="c"># m h dom mon dow  command</span>
<span class="k">*</span>/5 <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> <span class="k">*</span> /root/set_gitosis_permissions_to_view_on_gitweb.sh
</code></pre></div></div>

<p>This means that every 5 minutes, my bash file will set any new repositories to 0755. This is how to get Gitweb stood up. The next post will show how to hide it behind HTTP basic auth and a self-signed certificate.</p>

<p>Next Part: Hiding the Gitweb site</p>

<h2 id="comments">Comments</h2>

<p><strong><a href="#483" title="2010-07-09 22:07:08">katy lavallee</a>:</strong> Anxiously awaiting the next part :)</p>

<p><strong><a href="#513" title="2011-11-05 01:16:00">Thorpe</a>:</strong> You said you chose Bash so that you could take some time to learn it. Unfortunately however, your shebang points to sh not bash. There is some differences.</p>


      <footer class="entry-meta">
        
        <span class="author vcard"><span class="fn">Jason Meridth</span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-3/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=https://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-3/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=https://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-3/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->

      </footer>
    </div><!-- /.entry-content -->
    <div class="read-more">
  <div class="read-more-header">
    <a href="https://blog.jasonmeridth.com" class="read-more-btn">About the Author</a>
  </div><!-- /.read-more-header -->
  <div class="read-more-content author-info">
    <h3>Jason Meridth</h3>
    <div class="author-container">
      <p class="center"><img class="avatar" src="https://avatars3.githubusercontent.com/jmeridth?v=3&s=400" alt="jmeridth" srcset="https://avatars3.githubusercontent.com/jmeridth?v=3&s=400 1x, https://avatars3.githubusercontent.com/jmeridth?v=3&s=800 2x, https://avatars3.githubusercontent.com/jmeridth?v=3&s=1200 3x, https://avatars3.githubusercontent.com/jmeridth?v=3&s=1600 4x" width="400" height="400" data-proofer-ignore="true" /></p>
      <div class="author-bio">My name is Jason Meridth. I am a continuously learning senior software developer/team lead/development manager trying to not let best be the enemy of better. I reserve the right to change my mind upon obtaining more information.  I am also the owner and principal software consultant at Meridth, LLC.  If you have any software, hardward, networking, process, etc needs please don't hesitate to reach out to me.</div>
    </div>
    <div class="author-share">
      <ul class="list-inline social-buttons">
        
          <li><a href="https://github.com/jmeridth" target="_blank"><i class="fa fa-github fa-fw"></i></a></li>
        
          <li><a href="https://br.linkedin.com/in/jmeridth" target="_blank"><i class="fa fa-linkedin fa-fw"></i></a></li>
        
          <li><a href="https://twitter.com/jmeridth" target="_blank"><i class="fa fa-twitter fa-fw"></i></a></li>
        
      </ul>
      
        <a aria-label="Follow @jmeridth on GitHub" data-size="large" href="https://github.com/jmeridth" class="github-button">Follow @jmeridth</a>
      
      <br>
      
        <a href="https://twitter.com/jmeridth" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @jmeridth</a>
      
    </div>
  </div>
</div>

    
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="https://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-2/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="https://blog.jasonmeridth.com/posts/raspberry-pi-kubernetes-cluster-part-1/" title="Raspberry Pi Kubernetes Cluster - Part 1">Raspberry Pi Kubernetes Cluster - Part 1</a></h3>
      <p>HowdyThis is going to be the first post about my setup of a Raspberry Pi Kubernetes Cluster.  I saw a post by [Hart Hoover](https://harth...&hellip; <a href="https://blog.jasonmeridth.com/posts/raspberry-pi-kubernetes-cluster-part-1/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="https://blog.jasonmeridth.com/posts/ssh-too-many-authentication-failures/" title="SSH - Too Many Authentication Failures">SSH - Too Many Authentication Failures</a></h4>
        <span>Published on March 28, 2018</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="https://blog.jasonmeridth.com/posts/clear-dns-cache-in-chrome/" title="Clear DNS Cache In Chrome">Clear DNS Cache In Chrome</a></h4>
        <span>Published on March 27, 2018</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="https://blog.jasonmeridth.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="https://blog.jasonmeridth.com/assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>



<!-- Asynchronous Google Analytics snippet -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38456568-3', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>






<script type="text/javascript">
    sharing();
</script>



<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2018 Jason Meridth. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
