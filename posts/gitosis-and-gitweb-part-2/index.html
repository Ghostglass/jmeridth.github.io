<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Gitosis and Gitweb - Part 2 - Add Projects and Contributors | Jason Meridth's Blog</title>

                <link href="../../assets/css/bitter.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/main.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/code.css" rel="stylesheet" type="text/css">

                <link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">

      <link rel="canonical" href="http://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-2/">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    

    
    <meta name="author" content="Jason Meridth">
            <meta name="og:title" content="Gitosis and Gitweb - Part 2 - Add Projects and Contributors">
        <meta name="og:url" content="http://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-2/">
            <meta name="og:description" content="Gitosis and Gitweb – Part 1
So we are setup now thanks to Part 1.
Gitosis repository contents
If we issue the “find .” command locally inside the gitosis-admin directory we will see the following:
~/g">
        <meta name="og:site_name" content="Jason Meridth's Blog">
        <meta name="og:type" content="article">

    
    

</head>
<body>
    <section class="social">
        <ul>
                    <li><a href="../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="http://jasonmeridth.com" title="About Me"><i class="icon-user"></i></a></li>
            <li><a href="../../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="https://github.com/jmeridth" title="Github"><i class="icon-github"></i></a></li>
            <li><a href="https://twitter.com/jmeridth" title="Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>

        </ul>
    </section>
    <section class="page-content">
        <div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">Gitosis and Gitweb - Part 2 - Add Projects and Contributors</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2010-05-25T03:02:00-05:00">May 25, 2010</time>
            
            
            </div>
                    <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="../../categories/git/" rel="tag">git</a></li>
           <li><a class="tag p-category" href="../../categories/gitosis/" rel="tag">gitosis</a></li>
        </ul>
        </div>

        </div>
        <div class="body">
            <p><a href="../gitosis-and-gitweb-part-1">Gitosis and Gitweb – Part 1</a></p>
<p>So we are setup now thanks to Part 1.</p>
<h3>Gitosis repository contents</h3>
<p>If we issue the “find .” command locally inside the gitosis-admin directory we will see the following:</p>
<pre class="code literal-block">~/gitosis-admin<span class="o">(</span>master<span class="o">)</span> &gt; find .
&lt;a bunch of files from .git folder<span class="o">)</span>
./gitosis.conf
./keydir
./keydir/user@local.pub
</pre>


<p>We have the .git folder, a gitosis.conf file, and a keydir with a pub key file.</p>
<h3>Add our first project</h3>
<p>Our project name for this example is lostechies. If you view the gitosis-admin.conf file you will see the initial content like so:</p>
<pre class="code literal-block">~/gitosis-admin<span class="o">(</span>master<span class="o">)</span> &gt; cat gitosis.conf
<span class="o">[</span>gitosis<span class="o">]</span>

<span class="o">[</span>group gitosis-admin<span class="o">]</span>
<span class="nv">writable</span> <span class="o">=</span> gitosis-admin
<span class="nv">members</span> <span class="o">=</span> user@local
</pre>


<p>This is the result of the following command from the last part:</p>
<pre class="code literal-block">sudo -H -u git gitosis-init &lt; /tmp/id_rsa.pub
</pre>


<p>That command puts the public ssh key into the keydirs directory and adds the associated username from the file to be the first member of the gisotis-admin project. Hence seeing user@local as the member. It matches the filename of the pub file in the keydir directory (user@local.pub). That’s how gitosis relates members listed in the conf file to the keys in the keydir directory, filename minus the pub extension.</p>
<p>Let’s edit this conf file to include our lostechies project:</p>
<pre class="code literal-block">~/gitosis-admin<span class="o">(</span>master<span class="o">)</span> &gt; cat gitosis.conf
<span class="o">[</span>gitosis<span class="o">]</span>

<span class="o">[</span>group gitosis-admin<span class="o">]</span>
<span class="nv">writable</span> <span class="o">=</span> gitosis-admin
<span class="nv">memebers</span> <span class="o">=</span> user@local

<span class="o">[</span>group meridth<span class="o">]</span>
<span class="nv">writable</span> <span class="o">=</span> meridth
<span class="nv">members</span> <span class="o">=</span> user@local
</pre>


<p>It looks exactly like the gitosis-admin one. Now we commit it just like we would normally when using Git. We can add, then commit or commit with the -am argument. This is possible since the gitosis-admin.conf file is already tracked by the repository.</p>
<pre class="code literal-block">~/gitosis-admin<span class="o">(</span>master<span class="o">)</span> &gt; git commit -am <span class="s2">"add meridth project"</span>
<span class="o">[</span>master 6b7a5da<span class="o">]</span> add meridth project
1 file changed, 3 insertions<span class="o">(</span>+<span class="o">)</span>, 0 deletions<span class="o">(</span>-<span class="o">)</span>
</pre>


<p>and push it to the remote gitosis-admin repository:</p>
<pre class="code literal-block">~/gitosis-admin<span class="o">(</span>master<span class="o">)</span> &gt; git push
Counting objects: 5, <span class="k">done</span>.
Delta compression using up to 2 threads
Compressing objects: 100% <span class="o">(</span>3/3<span class="o">)</span>, <span class="k">done</span>.
Writing objects: 100% <span class="o">(</span>3/3<span class="o">)</span>, 385 bytes, <span class="k">done</span>.
Total 3 <span class="o">(</span>delta 0<span class="o">)</span>, reused 0 <span class="o">(</span>delta 0<span class="o">)</span>
To git@YOUR_SERVER_HOSTNAME:gitosis-admin.git
   23842e9..6b7a5da master -&gt; master
</pre>


<p>We need to create the lostechies repository locally, add an initial item (README in this case), and push it remotely. Gitosis won’t create the repository until something it pushed to it.</p>
<pre class="code literal-block">START HERE
</pre>


<p>The lostechies repository now exists remotely. Currently my account is the only that has access. Let’s add another contributor.</p>
<h3>Add our first contributors</h3>
<p>Say I want to allow my friend Joe to have commit (writable) access to my lostechies repository and I want my friend Ryan to only have readonly access. I tell them to send me their public ssh keys. I make sure the files are named joe.pub and ryan.pub. I then put them into my local gitosis-admin repository’s keydir directory and then I edit the gitosis.conf file to be:</p>
<p><img alt="" src="//lostechies.com/jasonmeridth/files/2011/03/Screen-shot-2010-05-24-at-10.14.27-PM.png"></p>
<p>Notice that I had to create a whole new group (lostechies_ro) to setup Ryan’s readonly access. You can’t combine readonly and writable permissions in gitosis (wish we could – open source contribution there?).</p>
<p>Now I need to “git add” the new keys, and commit the changes to the conf file. Finally I push the changes.</p>
<p><img alt="" src="//lostechies.com/jasonmeridth/files/2011/03/Screen-shot-2010-05-24-at-10.14.36-PM.png"></p>
<p>Now Joe or Ryan can clone this repository:</p>
<p><img alt="" src="//lostechies.com/jasonmeridth/files/2011/03/Screen-shot-2010-05-24-at-10.14.43-PM.png"></p>
<p><em><strong>NOTE:</strong></em> Again, if they receive the following error:</p>
<p><img alt="" src="//lostechies.com/jasonmeridth/files/2011/03/Screen-shot-2010-05-24-at-10.14.50-PM.png"></p>
<p>The solution, involving the .ssh/config file is in the first post in this series.</p>
<p>That is how you create a repository and add users.</p>
<h3>DEBUG</h3>
<p>If you are unable to connect you have the option of editing the gitosis.conf file with more message verbosity by adding “loglevel=DEBUG” at the top of the conf file:</p>
<p><img alt="" src="//lostechies.com/jasonmeridth/files/2011/03/Screen-shot-2010-05-24-at-10.14.58-PM.png"></p>
<p>This will give you more information on the ouput when trying to push to the remote repository.</p>
<h3>Can’t push changes</h3>
<p>As Scott Chacon states in his gitosis section of <a href="http://progit.org/book/ch4-7.html">Pro Git</a>:</p>
<blockquote>
<p>“If you’ve lost push access by pushing a messed-up configuration, you can manually fix the file on the server under /home/git/.gitosis.conf — the file from which Gitosis reads its info. A push to the project takes the gitosis.conf file you just pushed up and sticks it there. If you edit that file manually, it remains like that until the next successful push to the gitosis-admin project.”</p>
</blockquote>
<p>The .gitosis.conf file in the git user’s home directory is a symlink to the actual conf file in the gitosis-admin repository:</p>
<p><img alt="" src="//lostechies.com/jasonmeridth/files/2011/03/Screen-shot-2010-05-24-at-10.15.03-PM.png"></p>
<p>Next Part: Gitweb</p>
<h3>Comments</h3>
<p><strong><a href=".#478" title="2010-05-25 12:51:54">Gabriel N. Schenker</a>:</strong> your post come in handy; just at the right time! Very nicely done, thanks</p>
<p><strong><a href=".#479" title="2010-07-24 22:06:27">colvertlyn</a>:</strong> permafrost expected action cover <a href="http://gravity.wikia.com">million per absolute broadly</a> [url=http://www.skyandtelescope.com]emission small glacial observational[/url] http://www.nal.usda.gov</p>
<p><strong><a href=".#480" title="2010-07-24 22:06:47">salfordwil</a>:</strong> volunteer physical llc</p>
<p><strong><a href=".#481" title="2010-08-21 08:53:11">ashlynnega</a>:</strong> increased link <a href="http://www.unesco.org">rise sectors windows past</a> [url=http://water.usgs.gov]videos comment president android[/url] http://www.newswire.ca</p>
<p><strong><a href=".#482" title="2010-08-21 08:53:28">garrmankor</a>:</strong> economy regions hypothesis special</p>
<p><strong><a href=".#496" title="2011-05-12 10:24:00">Mullins</a>:</strong> After creating the losttechies repository locally I needed to create the remote 'origin' by executing: $ git remote add origin git@MYSERVER.com:losttechies.git</p>
        </div>
                <ul class="pager">
            <li class="previous">
                <a href="../gitosis-and-gitweb-part-1/" rel="prev" title="Gitosis and Gitweb - Part 1 - Setup">Previous post</a>
            </li>
            <li class="next">
                <a href="../gitosis-and-gitweb-part-3/" rel="next" title="Gitosis and Gitweb - Part 3">Next post</a>
            </li>
        </ul>

                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="jasonmeridth",
            disqus_url="http://blog.jasonmeridth.com/posts/gitosis-and-gitweb-part-2/",
        disqus_title="Gitosis and Gitweb - Part 2 - Add Projects and Contributors",
        disqus_identifier="cache/posts/gitosis-and-gitweb-part-2.html",
        disqus_config = function () {
            this.language = "";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        
    </div>
                    <footer id="footer" role="contentinfo">
            <p>Contents © 2014         <a href="mailto:jason@jasonmeridth.com">Jason Meridth</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>

        </div>
    </section>
    
    
                <script src="../../assets/js/jquery-1.10.2.min.js" type="text/javascript"></script>
            <script src="../../assets/js/jquery.timeago.js" type="text/javascript"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


        <script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
