<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Git Post-receive hook with integrity post call | Jason Meridth's Blog</title>

                <link href="../../assets/css/bitter.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/main.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
        <link href="../../assets/css/code.css" rel="stylesheet" type="text/css">

                <link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">

      <link rel="canonical" href="http://blog.jasonmeridth.com/posts/git-post-receive-hook-with-integrity-post-call/">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    

    
    <meta name="author" content="Jason Meridth">
            <meta name="og:title" content="Git Post-receive hook with integrity post call">
        <meta name="og:url" content="http://blog.jasonmeridth.com/posts/git-post-receive-hook-with-integrity-post-call/">
            <meta name="og:description" content="Using the following code:
This git post-receive hook script queries the latest commit, gets the revision changes, and then passes that payload (via json) to a net/https POST call. I setup our Integrit">
        <meta name="og:site_name" content="Jason Meridth's Blog">
        <meta name="og:type" content="article">

    
    

</head>
<body>
    <section class="social">
        <ul>
                    <li><a href="../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="https://github.com/jmeridth" title="Github"><i class="icon-github"></i></a></li>
            <li><a href="https://twitter.com/jmeridth" title="Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="http://jasonmeridth.com" title="About Me"><i class="icon-user"></i></a></li>
            <li><a href="../../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>

        </ul>
    </section>
    <section class="page-content">
        <div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">Git Post-receive hook with integrity post call</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2009-07-17T05:01:00-05:00">Jul 17, 2009</time>
            
            
            </div>
            
        </div>
        <div class="body">
            <p>Using the following code:</p>
<p>This git post-receive hook script queries the latest commit, gets the revision changes, and then passes that payload (via json) to a net/https POST call. I setup our <a href="http://www.integrityapp.com/">Integrity CI server</a> with a self-signed certificate and HTTP basic authentication.  </p>
<p>The Net::HTTP::Post.new instantiation group handles populating the basic authentication information and putting the payload into the form data of the request. The Net::HTTP.new group handles telling the request that it will be via SSL (443) and to not verify the SSL certificate (since I'm using a self-signed certificate; otherwise, I'd get a warning and kill my automation process)  </p>
<p>The other important part is the "if pid = fork". The ruby <a href="http://www.ruby-doc.org/core/classes/Process.html#M003179">fork</a> command allows code to happen in the background, in the case the POST call, and therefore make the call synchronous. Otherwise, when the developers commit their code to the repository, they will have to wait for the build to finish before their prompt will be returned to them. fork will return zero (0) if it fails to create the background process.  </p>
<p>I'm still checking whether the zombie process warning in the rdoc (for the fork command) is a problem. I'll update this if it is.  </p>
<p>The last line is notification for the user so they know what's going on. Always good to keep the user in the loop. :)</p>
<h3>Comments</h3>
<p><strong><a href=".#446" title="2009-07-22 05:25:21">not-impossible</a>:</strong> The code doesn't show up in the Google reader. Any idea why? do you use some funny code highlighting? Cheers</p>
<p><strong><a href=".#447" title="2009-07-22 16:05:56">Jason Meridth</a>:</strong> @not-impossible Unfortunately RSS feeds won't allow nested code that lies in a script tag and that is what gist.github.com uses. I may have to go back to dp.syntaxhighlighter.</p>
        </div>
                <ul class="pager">
            <li class="previous">
                <a href="../git-for-windows-developers-git-series-part-4/" rel="prev" title="Git For Windows Developers – Git Series – Part 4">Previous post</a>
            </li>
            <li class="next">
                <a href="../git-local-pre-commit-hook/" rel="next" title="Git local pre-commit hook">Next post</a>
            </li>
        </ul>

                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="jasonmeridth",
            disqus_url="http://blog.jasonmeridth.com/posts/git-post-receive-hook-with-integrity-post-call/",
        disqus_title="Git Post-receive hook with integrity post call",
        disqus_identifier="cache/posts/git-post-receive-hook-with-integrity-post-call.html",
        disqus_config = function () {
            this.language = "";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        
    </div>
                    <footer id="footer" role="contentinfo">
            <p>Contents © 2014         <a href="mailto:jason@jasonmeridth.com">Jason Meridth</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<br><br>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a></p>
            
        </footer>

        </div>
    </section>
    
    
                <script src="../../assets/js/jquery-1.10.2.min.js" type="text/javascript"></script>
            <script src="../../assets/js/jquery.timeago.js" type="text/javascript"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


        <script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
